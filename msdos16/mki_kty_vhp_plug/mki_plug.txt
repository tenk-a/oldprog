	MKI,KTY(KT4),VHP,BLK --> DJP,BMP コンバータ

			MKI_PLUG ver1.00
			KTY_PLUG ver1.00
			VHP_PLUG ver1.00
			BLK_PLUG ver1.00



■　はじめに

　　　mki_plug, kty_plug, vhp_plug, blk_plug は、 MKI, KTY, VHP, BLK
　　画像ファイルを BMP や DJP に変換する画像コンバータです。

　　　mki,kty,vhp はオンライン配布で今ではあまり使われなくなった画像
　　フォーマットでですが（blkは用途が違うもんだけどついでで^^）、 だ
　　からといってこれらのフォーマットの画像ファイルの存在が０というわ
　　けでなく、また PC互換機(DOS/V機)等ではローダがない(と思われる)の
　　で、とりあえずコンバートだけでもできたら、と、作成しました。

　　　名前を見てのとおり、戦うクラリス氏考案の DJPプラグインになって
　　います。
　　　が、ちょい拡張して BMP生成も行えるようになっています。



■　つかいかた

　　　usage: ???_plug [-a] <COMMAND> <INPUTFILE> <OUTPUTFILE>

　　??? は、mki,kty,vhp,blk のいずれかです。

　　<COMMAND> は出力方法を指定します。 DJ505JC, TO_DJP, TO_BMPを指定
　　できます。
　　　DJ505JC を指定すれば、DJPプラグイン(DJPファイルを生成)として機
    能します。もし640*200画像ならば、640*400画像に変換します。
　　　TO_DJP,TO_BMPならば、DJP,BMPファイルを生成しますが、ドットの比
　　率による調整はしません。640*200画像をBMPで出力すると解像度として
　　(2000,4000)が設定されます。
　　ただし -a オプションを指定すると TO_DJP,TO_BMP でも DJ505JC と同
    じように640*200画像を640*400画像にして出力します。
　　　なお、DJP プラグインで規定されているモノクロ出力指定の DJ505JM
　　については未対応です。指定してもDJ505JCとして処理されてしまいます。

　　<INPUTFILE>,<OUTPUTFILE>はそれぞれ入力ファイル名、出力ファイル名
　　で、指定されたそのものを用います。ワイルド・カード文字とか拡張子
　　の自動付加等の機能は全くありません。
　　基本的に ローダ等のDJPプラグインや 拙作 abx のような画像コンバー
　　タ相互呼び出しツールの子プロセス起動を主に想定しており、コマンド
　　ラインで直接指定するときの便宜はあえておろそかにしました。



■　画像フォーマットについて

□　DJP フォーマット(.DJP)

　　　戦うクラリス氏考案の DJPプラグインで使われるベタな画像フォーマ
　　ットです。256色画(ｶﾗｰorﾓﾉｸﾛ)と 24ビット色画が定義されてますが、
　　このツール郡ではパレット付き 256色画でのみ生成します。

　　　DJPフォーマット自体の利用は商利用も含めて自由のようです。
　　フォーマットや利用条件の詳細は戦うクラリス氏の PHANTOM5.LZH（NIF
　　FGALAV DL 5で入手可能）に同梱されている DJP.SPC を参照してくださ
　　い。


□　ＢＭＰフォーマット(.BMP)

　　　MS-WINDOWSの壁紙. ほんとはDIBフォーマットというらしい。
　　16色,256色,24ﾋﾞｯﾄ色があるが、このツール郡では16色画のみ生成。

　　　実は利用条件とか知らなかったりする^^; でも、世の中の状況からし
　　てフリーソフト程度ならば問題ないんだろうなと思える。
　　MS-WINDOWSの開発関係の本みりゃかいてるのかもしれんがようわからん。
　　　NIFTY FGALAV DL 2 に contrail 氏の書かれた DIBフォーマットの解
　　説書(DIB_FORM.LZH,DIB_FRM2.LZH) があるのでそれをみればフォーマッ
　　トについてはわかるでせう。


□　ＭＡＫＩフォーマット(.MKI)

　　　W_RINN 氏作のフォーマットで、日本国内の 16色画像の標準的フォー
　　マット MAG（鮪:MAKI02）の前身（MAKI01）。
　　　実質 640*400 の16 色画像のみのようで、部分セーブ等定義されてい
　　るけど使われる前に MAG に移行したようです。

　　　MAKIフォーマットの利用条件については MKBIBLE.DOC（W_RINN氏著.
　　NIFTY FGALAV DL 2で入手可能）を参考してください。

　　　mag_plug では 16色640*400画像にのみ対応してます。
　　　MKBIBLE.DOC を元に作成しました。


□  Ｋｉｔｔｙフォーマット(.KTY|.KT4)

　　　MKI/MAG 出現以前のデジタル８色画像の時代において、それなりに普
　　及していたフォーマット。
　　　.KTYは 8色640*200、.KT4は 8色640*400画像の拡張子。
　　　フォーマット作者は Rabbit 氏で、もともとは Kitty soft とかいう
　　ソフトハウスのフォーマットらしい。　細かいことは覚えてないけど、
　　フォーマット利用条件は MAKIとかPICとかと大差なかったと思う... 商
　　利用に関しては不明ですがフリーソフトにおいてはKTY フォーマットツ
　　ールの配布条件はツール作者の自由だったはずです（そう答えてもらっ
　　た覚えが...ｳﾛｵﾎﾞｴ）。

　　　8 ビット機が現役のときのフォーマットであり圧縮率は今の基準から
　　すればあまりよくないけど、遅い展開速度をカバーするかのようなユニ
　　ークな展開方法で趣のある表示をしてました（単純に比較はできんけど、
　　8ビット機って初代98よりも遅いのんね... 今やcpubenchでざらに100越
　　えること思うと...）

　　　このkty_plugは, FM7 FBASIC 版のソースを分けてもらって FM7/11の
　　OS9に移植したときのasmｿｰｽを発掘して cに書き直して作成しました。


□　ＶＨＰフォーマット(.VHP)

　　　640*200か640*400 で 8色または16色の画像フォーマット。
　　　フォーマット作者はマシーンＭ氏(NIFTY  MAH02663)。
　　　８色画から16色画への過度期に出現したものですが（某草の根ネット
　　で推奨フォーマットになってたりした）、結局普及にはいたりませんで
　　した。

　　　圧縮率はQ4並みで、KTYの流れを組む(?)ユニークな展開方法でした。

　　　vhp_plug は、マシーンＭ氏のvhload のソースの展開部分をそのまま
　　用いて（名前付け替えたり順番かえたり余計な変更を山ほどしてますが）、
　　作成しました。

　　　なお、VHP フォーマットは営利目的の利用は禁止されています。移植
　　やフォーマット改変物の配布等にはフォーマット作者の許可が必要です。
　　（詳しくはマシーンＭ氏のvhp のソース&DOCを入手してください^^;
　　　って草の根のネットでしか見つからないかも）


□　ＢＬＫフォーマット(.BLK)

　　　アリス・ソフトのゲームの画面セーブで生成されるファイルです。
　　98のパレット、VRAMをベタに出力したもので、フリーソフトの物故ツー
　　ルとかでも使われているようです。

　　　フォーマットの利用条件とかはどうなってるのかしりませんがフリー
　　ソフトとかでは問題ないと思われます（まあヘッダ無ベタファイルやし）

　　　blk_plug は、tofmt4p.c ルーチンの デバッグ用に一番最初に作った
　　だけだったりします^^;



■　他のフォーマットへのコンバート（宣伝）

　　　DJP と BMP しか生成できませんが、 BMP から別のフォーマットへの
　　コンバータはそれなりにあると思うのでなんとかなるでしょう。
　　　拙作 mg.exe を用いれば DJP,BMP->MAG,Pi,TIF,Q0 等の変換が行える
　　でせう。また、拙作 abxを用いれば ???_plugと mgを連動して複数ファ
　　イルを一括変換できます。 ただし abx(g)の定義ファイルに定義を追加
　　する必要があります。abx(g).cfgの最後に以下を追加してください。
----------------------- ｷ ﾘ ﾄ ﾘ ｾ ﾝ --------------------------------

:{kty|kt4}:{bmp|djp|pmt}
	-x -e$1 =
	kty_plug to_$2 $f $p\$x.$2

:{kty|kt4}:{mag|pi|tif|blk|b1|frm|rgb|q0}
	-x -e$1 =
	kty_plug TO_BMP $f $w\_.bmp
	mg -xc .bmp.$2 $w\_.bmp -f$p\$x.$2
	del $w\_.bmp

:VHP:{bmp|djp|pmt}
	-x -eVHP =
	vhp_plug TO_$1 $f $p\$x.$1

:VHP:{mag|pi|tif|blk|b1|frm|rgb|q0}
	-x -eVHP =
	vhp_plug TO_BMP $f $w\_.bmp
	mg -xc .bmp.$1 $w\_.bmp -f$p\$x.$1
	del $w\_.bmp

:MKI:{bmp|djp|pmt}
	-x -eMKI =
	vhp_plug TO_$1 $f $p\$x.$1

:MKI:{mag|pi|tif|blk|b1|frm|rgb|q0}
	-x -eMKI =
	mki_plug TO_PMT $f $w\_.pmt
	mg -xc .pmt.$1 $w\_.pmt -f$p\$x.$1
	del $w\_.pmt
----------------------- ｷ ﾘ ﾄ ﾘ ｾ ﾝ --------------------------------
　　でも v1.00よりも新しいバージョンになれば、追加の必要はなくなって
　いることと思います^^;



■　配布条件等

　　　フリーソフトウェアです。パソ通(ｵﾝﾗｲﾝ) での非営利配布ならば作者
　　に連絡不要で再配布していただいてかまいません。その他の場合（雑誌
　　紹介とかディスク配布で同梱したいなど）事前に相談ください、ってこ
　　とで^^;（配布圧縮ファイルの内容をかってに改編しないこと）
　　　ソースの扱いについては、vhp_plug.c 以外は フリーソフトへの流用
　　ならば自由にしていただいて結構です。ただし各フォーマットの利用条
　　件等は必ず各自で調べてください（基本的に大元のフォーマット解説書
　　を参考にしませう...って, KTY,VHP,BLKは...^^;）。
　　　tofmt4p.c に関してはローダ作者の方がコンバータに改造していただ
　　くのに利用・参考していただけると本望でせう。

　　　なお、配布ファイル中の実行ファイルは Borland-C v3 でコンパイル
　　してありますが、ソース自体は比較的簡単に他のコンパイラでもコンパ
　　イルできるはずです（モトローラ系でも大丈夫のはず）

　　　あっと。
　　　作者はいかなる責任も義務も負いません。利用者の責任で用いてださ
　　い。例によって十分なチェックなんて行ってるわけないので、気をつけ
　　てくださいませ。



■  おわりに

　　　ちょっと前に NIFTY fgalav で KTY 画をBMPに変換したいという話が
　　出てたのに影響され、でもて、気がつくとPC互換機を入手していた都合
　　で、あまり必要ないとはいえ98で出来たことがPCでできないのも何なの
　　で作ってみました。
　　　って、そんなこというと他にもやるべきことあるだろう、と言われか
　　ねないな^^; はやい話、単なる気まぐれなんですが。

　　　デバッグのために昔入手した８色画を出して来て試してましたが、奇
　　麗なものはやっぱり奇麗ですね（16色でWINしてる人には8色画は恵かも）



						てんか☆（北村雅史）
						NIFTY	    NBB00541
