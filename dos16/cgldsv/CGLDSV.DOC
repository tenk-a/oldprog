ＣｇＬｄＳｖ  Ver.1.14


　おもに部分セーブを目的に作成した画像コンバータです. 

　ローダとセーバを交互に起動して画像をコンバートします。  つまり、変換には
ローダとセーバが必要です^^; でもって、セーバは、mag/magd,pi/dopisv/pi98 を
前提にしています. 

　オプションで部分セーブを行えます。ローダを用いて画像を表示し、その画面で
背景色以外の部分が収まる四角形の座標（ただし横は８ドット間隔）を求め、その
座標をセーバに渡して部分セーブを実行します。

  対象とする画像は基本的には 640 * 400, 16色画面に収まるものです. 
1280*400, 640*800の画像のロードは、ローダが表VRAMからはみ出した部分を裏VRAM
に展開してくれるものでないといけませんし、セーバもそれに対応してくれていな
いといけません^^;. 



□  つかいかた

usage: cgldsv [-option(s)] file(s)...

　指定するファイルはロードするファイル名です. 
  -lm,-lp 等でローダを指定したばあいは拡張子はわかるのでファイル名の指定で拡
張子を省略できますが、-s= でローダを指定したばあいは拡張子はわからないので省
略できません.
　セーバに渡すファイル名は、ディレクトリ名(ドライブ名)と拡張子が削除されます.
よって、基本的にカレント・ディレクトリにファイルが作成されることになります.
  ファイル名はワイルド・カード対応です（ただし、再コンパイルするコンパイラ
によっては不可になるばあいあり）. 

　ファイル指定でのワイルド・カード機能はMSDOS本来のものより拡張されており、

　　*	　0文字以上の任意の文字列に一致
　　?	　任意の一文字に一致
　　[..]　[ ] 内の文字列のどれか一文字に一致
　　[^..] [^ ] 内の文字列以外の一文字に一致
　　      括弧内では 0-9 のように'-'による範囲指定も可
　　      また、括弧内では他のワイルドカード文字は機能しない

というようなのがあります.
  また、パスの区切りには \ だけでなく / も使えます.



□　オプション

  -b[N]
    背景色を N(0-15) にして部分セーブを行います. N 省略は 0 です.
    この色番号以外の部分が収まる長方形の座標を求めることになります.
    このオプションを指定しないばあいは座標を探さずに画面全体の長方形の
    座標を用います.

  -i
    背景色の代わりに裏VRAM と比較して違う部分の座標を求めます.

  -c[N]
    画像をロードする前に画面を色番号 N(0-15) で画面を埋めます.
    N 省略は 0 です.
    -c-のときこの動作を行いません.

  -l=Name
    デフォルトのローダ以外を使うばあいにローダ名を指定します.
    現在のVRAM をセーブしたいばあいは、Name を指定せず -l= のみを指定す
    ればローダを使用せず、行えます.

  -l-OPT
    ローダに渡したいオプション(-OPT)を指定します. 
　　オプションはファイル名の直前におかれます. 
    -l-OPT は全部で10個指定できます. 

  -lm
    ローダとして Mag を使用します.

  -lp
    ローダとして DoPI(Piローダ) を使用します.

  -lq
    ローダとして hsx(Q4ローダ) を使用します.

  -s=Name
    デフォルトのセーバ以外を使うばあいにセーバ名を指定します.
    Name を指定せず -s= のみだとセーバを使用しません.

  -s-OPT
    セーバに渡したいオプション(-OPT)を指定します. 
　　オプションはファイル名の直前におかれます. 
    -s-OPT は全部で10個指定できます. 

  -sm
    セーバとして mag を使用します.

  -sp
    セーバとして pi を使用します.

  -2
    縦の範囲を0〜199 までにし、セーバに200ラインモード・オプション(-2)を渡
    します.
    とりあえず pi/dopisv/Pi98, mag/magd にしか対応していません.

　-wx[-OPT]
  -wy[-OPT]
　　裏VRAMをつなげて1280*400(-wx) または640*800(-wy)の範囲で座標を探します.
    基本的にローダは dopi(pi), Magd にしか対応していません.
    640*400をはみ出す部分を裏VRAMに展開できるローダでないと哀しいでせう. 
    -OPT はローダにわたす（裏VRAMに展開するための）オプションです. 
    他のローダ、たとえば magd を用いるばあいは, 
      -l=magd -wy-lw
    のようにしてください.
    セーバももちろん, 640*400以上の画像に対応していないと哀しいでせう. 

　　（Pi98(v0.57) は 横に広い(1280*400)の画像には対応していないので、セーバ
　　　には pi.exe か dopisv を使って下さい）

  -m
    ローダとして Magd、セーバとして pi を用いてPi画像を生成し、そのあと、
    PiHdr で mag ファイルの情報を pi ファイルにコピーします.
    （要PiHdr.exe v.1.50以降）
    MAG->PI は別途ツールがあるので、現在はまず使わないオプションです。

  -v[0][=FILE]
    実際にはセーブをおこなわず、ローダ、セーバ命令をFILE に記録します. 
    -v0 ならロードも行いません. 
    作成された FILE は、拡張子を.BAT にすれば画像コンバートのためのバッチ・
    ファイルになります.

　@FILE
　　ファイル FILE より、オプションを得ます。ファイル中では、改行は空白扱い
　　で、#があると行末までコメントとし空白扱いします。
　　このファイル中に ファイル名 を書くことはできません。

なお、オプションはまず最初に -c0 -l= -sp が指定されてます.



□  そのた

  mag<->pi に関しては、別に配布している拙作 MG.exe でキチンと行えるのでそ
ちらを使っください。MG.exe は mag<->piだけでなく DOS 汎用で MAG,Pi,BMP,TIF,
B1(+R1+G1+E1),FRM を相互変換できます（Q0/RGB出力も可）。自前で展開圧縮を行
うのでサイズが640*400以上でも安心です（宣伝宣伝 ^^;）

　ロードするファイル名とセーブするファイル名の拡張子が同じばあいは、かなら
ずロードするディレクトリとセーブするディレクトリを別々にしてください. 

  パレットは考慮しないので、ローダとセーバの都合を各自で調整してください.
ローダ、セーバが常駐パレット対応ならそれでよし. セーバが.rgbパレット・ファ
イル対応なら cgldsv を実行する前にコンバートする画像すべての .rgb パレッ
ト・ファイルを用意(作成)しておく等してください. 

　ローダの起動は単にファイル名を与えて起動するだけなので、たいてい大丈夫だ
と思いますが、セーバは mag/magd, pi/dopisv/pi98 を前提にしているので、セー
バへわたすオプション（セーブ範囲とか200ラインモードとか）がこれらと違うば
あいは駄目ということになります. 



□  利用ソフト

　mag は Sam氏作の mag ローダ・セーバです. （v1.15c）
  magd/magdsave は TAK氏作の mag ローダ／セーバです. （v1.24c/v1.04）
  HSX は Mery氏,Manami氏作の q4 ローダです. （v4.17）
  Pi は BERO氏作の piローダ・セーバです. （v0.22b）
　Pi98 は JUNTA氏&LOCKE氏作の Pi ローダ・セーバです. （v0.57）
　DoPI/DoPiSv は拙作の Pi ローダ/セーバです. （v1.10/v0.91）
　PiHdr は拙作の Pi のヘッダ表示＆変更プログラムです（v1.53）

　なお、行末の括弧内はぼく（てんか☆）が利用しているバージョンです. バージ
ョンの違いでオプションが変わっている可能性があるのでそのときは修正して再コ
ンパイルしてください. 



□  おわりに

  省略時の設定はぼくの都合になってますし、セーバやローダに渡すオプションは
mag/magd,pi/dopisv/pi98 を前提にしているので、修正して再コンパイルしたほう
がいいでしょう.
　TC(++)でコンパイルしています。前は LSI-C でもコンパイルしてましたが、今
は未確認です。msc や qc は知らない...どうなんだろ...？

  フリーソフトウェアとします. 非営利なら転載自由で、連絡不要です.
  改造、引用もするのは自由ですが、改造物の再配布では、入手したすべての人に
オリジナルが存在し改造物であることを最低限伝える必要があり、原作者と同じ配
布条件でないといけなせん.
  もちろん、作者はいかなる義務も責任も負いません. あとは、まあフリーウェア
の常識の範囲で考えてください^^;

　あっと。転載してくれたら、どこそこに転載したよ、って可能ならひとこと連絡
してくださると非常にうれしいです（作者が喜ぶだけで、義務ではないよン）
でもって、バグも連絡していただけるとありがたいです. 代わりに虫取りしていた
だけるともっとうれしい^_^;

						てんか☆
						ＮＩＦＴＹ         NBB00541
						二の次(贋作)倶楽部	#31
						Magical-BBS大阪 	#84
