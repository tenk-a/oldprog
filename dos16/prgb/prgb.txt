ＰＲＧＢ　ver. 1.03



    　画像ファイルなどのバイナリファイルの指定した位置より48,32 or24
    バイトをRGB パレット・データとしてよみこみ、98のパレットや常駐パ
    レットに設定したり、RGB,PAL,ALG ファイルにして出力したりできます。
    もちろん入力ファイルとしてRGB ファイルも指定できます。

      また、テキスト・ファイルである PAL ファイル、RGB形式でない ALG
    ファイルも入力できるようにしているので、RGB,PAL,ALG 間のコンバー
    トとかにもつかえます。

    他、単に９８の常駐パレットの内容表示やトーンの変更等にも使えます。



□  つかいかた

    usage: prgb [-opts] [file(s)]...

      オプション、ファイルは複数指定可能です. オプションは先に収得さ
    れます.
      ファイル名の拡張子が省略されると RGBが指定されたことになります.
      収得時の B,R,G の順番はとりあえず固定していますが、-x で順番は
    換えられます.

    　ファイル指定でのワイルド・カード機能は MSDOS本来のものより拡張
    されており、

    　　*	　0文字以上の任意の文字列に一致
    　　?	　任意の一文字に一致
    　　[..]　[ ] 内の文字列のどれか一文字に一致
    　　[^..] [^ ] 内の文字列以外の一文字に一致
    　　      括弧内では 0-9 のように'-'による範囲指定も可
    　　      また、括弧内では他のワイルドカード文字は機能しない

    というようなのがあります.
      また、パスの区切りには \ だけでなく / も使えます.



□  オプション

  -?
      簡単な説明を表示します.

  -d
      パレット・データの内容を表示します.
      ファイルの指定のないときは常駐パレットの内容を表示します.

  -i
      パレットの初期化を行います.
      単にデフォルトの１６色を設定するだけです.

  -8
      パレット１６色をデジタル８色に設定します。
      ０〜７と８〜１５に同じ色が設定されます。

  -q-
      常駐パレットや９８のパレットの設定を行いません.
      パレット・データのコンバートを行うだけのばあい、わざわざパレッ
    トを設定する必要ないので、このオプションを指定すれば９８以外でも
    利用できます（もっとも、再コンパイルしてしまえば、もっと楽だけど）

  -v[N]
      パレットのトーンを N % にします. 省略は N=50.
      -r(-wp,-wa)では、この値で計算してから出力するので、気をつけてく
    ださい.
    ファイルが指定されていなければ、常駐パレットのトーンを変更するだ
    けです.

  -r[FILE]
      パレットの内容を RGB ファイル FILE.RGB に出力します.
      -v が指定されていれば、トーンを計算した値を出力します.
      FILE省略時は、ファイルが指定されていればディレクトリ名を取り除
    き（つまりカレントディレクトリに）、拡張子を.RGBにしたフィイルに
    出力します. ファイルが指定されていないばあいはエラーです.

  -wr[FILE]
      -r とまったく同じです.

  -wp[FILE]
      -r と同様ですが、RGBファイルでなく PAL ファイルに出力します.

  -wa[FILE]
      -r と同様ですが、RGBファイルでなく ARG ファイルに出力します.

  -l[N]
      N が正または0ならパレットの値をファイルの先頭Nバイト目より収得、
      N が負ならばファイルの最後から Nバイト目より収得します.
      N省略は 0.
      N は 0 で始まると、８進数、0xで始まると16進数となります.

  -x[N]
      RGB の並びを変更します. N:0-5 の６通り.
      0:RGB,012 1:BRG,201 2:GBR,120 3:GRB,102 4:BGR,210 5:RBG,021
    
  -cN,R,G,B
      パレット N を変更します.
      N,R,G,B:0-15,A-F

  -m[M][,Nr,Ng,Nb]
      ファイルからのパレット・データの収得の仕方を変更します.

      M=0:48バイト RGBデータ. 各バイトの下位４ビットを利用
        1:48バイト RGBデータ. 各バイトの上位４ビットを利用
        2:32バイト. 1ﾜｰﾄﾞ(0000GGGGRRRRBBBB)*16. ﾜｰﾄﾞはｲﾝﾃﾙ形式
        3:32バイト. 1ﾜｰﾄﾞ(0000GGGGRRRRBBBB)*16. ﾜｰﾄﾞはﾓﾄﾛｰﾗ形式
        4:24バイト. 3byteｾｲｽｳ*8. G1R1B1G0R0B0. ｲﾝﾃﾙ形式
        5:24バイト. 3byteｾｲｽｳ*8. G1R1B1G0R0B0. ﾓﾄﾛｰﾗ形式

      M=2,3では [Nr,Ng,Nb] が指定できます.
      １ワード中の指定された位置の４ビットを R,G,B の値にします.
    Nr,Ng,Nbはワード下位からの各 R,G,B データの最下位ビットの位置...
    別のいいかたをすれば, N ビット右シフトしてから下４ビットとりだし
    ます.
      Nr,Ng,Nb 省略時は 4,8,0 が指定されたことになります.

      M=4,5では M=2,3と同様に[Nr0,Ng0,Nb0,Nr1,Ng1,Nb1]が指定できます.
    省略は -m[M],4,8,0,16,20,12 .


  -eEXT
      拡張子を省略したばあい、普通は"RGB"が付加されるが, かわりに EXT
    を省略時の拡張子にします。

  @OPTFILE
    ファイル OPTFILE よりオプションを入力します.
    OPTFILEの中にはファイル名は指定できません.


    　なお、起動時はオプションは, -x0 -m0 -l0 -v100 が指定されている
    ことになります.

      あと、 Magd のマネをして言うと、オプションは覚えるものではあり
    ません。引くものです^^.   さすがにどんな機能があるかぐらいは把握
    しといたほうがいいですが。 使うときに prgb -? や prgb -m? で、オ
    プションとそのパラメータを確認してください。



□  PAL ファイル

    　PAL ファイルというのはエスキース（グラフィック・エディタ）のパ
    レット・ファイルらしいですが... ぼくはよくはしらない^^;
      ぼくは metys / Kleenex 氏作のpal2rgb （ドキュメント） を参照し
    ました...

      楽にテキストでパレットを作成したかったので、とりあえず PALを採
    用しました.
    でも、もっと楽したいので実際の PALファイルよりも拡張した仕様にな
    っています^^;

    　PAL ファイルは以下のような
    　　　10	15	15	0
    のように
      　　N		R	G	B
    　  （N:パレット番号  R:赤  G:緑  B:青  N,R,G,B:0-15）
    の行が並んだもので、値間の区切りは空白またはタブで、番号は別に順
    番に並んでる必要のないものらしいです.

      で、この PRGB では、入力してみて、数値がならんでいれば、上のよ
    うな形式であるとして収得していきます.

    　実際には空白、タブ、改行は空白扱いで、数値４つを一組として扱う
    ので、１行に５つ以上数値があったばあいの処理はオリジナルのとは違
    ってくるでしょう.

    　入力するデータのＲＧＢの順番を代えたい場合や番号無しで指定した
    いばあいは"N G R B"や"R G B"という行を先に指定します.
    　もちろん、"N B R G"とか、"B R G" とかも可能で、RGBの組み合せ 6
    通りに N 指定があるので全部で 12通りあります.
    　"N G R B"なら、その後の数値は４つで１組、"R G B"なら、３つで一
    組で番号は０から順に与えられます.

    　数値は、0から15 ですが、10から15 の１６進数表現として、単に A 
    から F も可能で、他にも 0xF や 0FH, $F, というようなもの可能です.
    　Ｃやアセンブラのソースからパレット・テーブルを抜き出して RGBフ
    ァイルを作成したいときのためにあります^_^

      あと、#で始まる単語があると行末までコメントとなります.
    　これら以外も文字があらわれるとエラーとなります.



□  使用例

  ◇  ある画像ファイルよりRGBパレット・データを抜き出す. その１

    　ある画像ファイルの拡張子が .GG1 で、ファイルの先頭より $10から
    $4f までの３×１６バイトがパレットデータで、ＢＲＧ順だとすると、
    　prgb -eGG1 -l16 -x1 -r *
    としてやれば, カレントディレクトリのGG1ファイルのrgbファイルを作
    成できます. また、
    　-eGG1 -l16 -x1
    の一行を GG1 というファイルにしておかば、@ファイル 機能を用い、
      prgb @GG1 -r *
    のようにもできます.

      ＲＧＢの順番は、ひとつ画像を表示しておいて、-xオプションで６通
    りを試して丁度いいのを選びます。
    

  ◇  ある画像ファイルよりRGBパレット・データを抜き出す. その２

    　ある画像ファイルの拡張子が .GG2 で、ファイルの先頭より $20から
    $3f までの２×１６バイトがパレットデータで、２バイトはインテル形
    式でその内訳が0000rrrrbbbbgggg とすると、
    　prgb -eGG2 -l32 -m2 -x5 -r *
    としてやれば, カレントディレクトリのGG2ファイルのrgbファイルを作
    成できます. 


  ◇  ソース・ファイルのパレット・テーブルをRGBファイルにする

    　たとえば、Ｃのソースで次のような配列が
    　　char grb[48] = {/* G R B 順 */
	    0x00,0x00,0x00, 0x03,0x06,0x03, 0x05,0x0A,0x06, 0x03,0x04,0x09,
	    0x01,0x02,0x06, 0x00,0x0f,0x02, 0x0c,0x0D,0x01, 0x0C,0x0C,0x0C,
	    0x0A,0x0E,0x08, 0x0D,0x0f,0x09, 0x0E,0x0F,0x0A, 0x0F,0x0F,0x0C,
	    0x0A,0x04,0x04, 0x0d,0x02,0x04, 0x0F,0x08,0x06, 0x0F,0x0F,0x0F
	};
    ありこれを rgbファイルにしたいばあい.
    　エディタで数値の部分をぬきだし、コンマは空白に置換し、

	    G R B
	    0x00 0x00 0x00  0x03 0x06 0x03  0x05 0x0A 0x06  0x03 0x04 0x09
	    0x01 0x02 0x06  0x00 0x0f 0x02  0x0c 0x0D 0x01  0x0C 0x0C 0x0C
	    0x0A 0x0E 0x08  0x0D 0x0f 0x09  0x0E 0x0F 0x0A  0x0F 0x0F 0x0C
	    0x0A 0x04 0x04  0x0d 0x02 0x04  0x0F 0x08 0x06  0x0F 0x0F 0x0F

    というようなファイルを(たとえば)ex.palとして作成し
        prgb -r -x3 ex.pal
    を実行すれば、ex.rgb が作成されます.



□  おわりに

    　このプログラムは TC(++) でコンパイルされています.

      フリーソフトウェアとします. 非営利ならば転載自由で連絡不要です.
      改造、引用もするのは自由ですが、改造物の再配布では、入手したす
    べての人にオリジナルが存在し改造物であることを最低限伝える必要が
    あり、原作者と同じ配布条件でないといけなせん.
      もちろん、作者はいかなる義務も責任も負いません. あとは、まあフ
    リーウェアの常識の範囲で考えてください^^;
    （妖しいツールのくせして、常識なんて持ち出すとは^^;）

    　あっと. 転載してくれたら、どこそこに転載したよ、って可能ならひ
    とこと連絡してくださると非常にうれしいです（作者が喜ぶだけで、義
    務ではないよン）
    でもって、バグも連絡していただけるとありがたいです. 

					    てんか☆
					    Nifty           NBB00541
					    二の次倶楽部	 #31
					    Magical-BBS大阪 	 #84
